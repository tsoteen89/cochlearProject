<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v5.0.2.min.js"></script>
    <script src="audiogram.kinetic.js"></script>  
    <style>
        body {
            margin: 10px;
            padding: 10px;
        }
        .aud-btn{
            font-size:24px;
        }
        .aud-btn span{
            text-align:center;
        }
        
        .aud-btn .left{
            float:left;
            margin-left:-5px;
        }
        .aud-btn .right{
            float:right;
            margin-right:-5px;
        }
        .aud-btn .mid{
            font-size:.5em;
            margin-left:20px;
            margin-right:20px;
        }
        /* centered columns styles */
        .row-centered {
            text-align:center;
        }
        .col-centered {
            display:inline-block;
            float:none;
            /* reset the text-align */
            text-align:left;
            /* inline-block space fix */
            margin-right:-4px;
            padding:0;
        }
        .col-fixed {
            /* custom width */
            width:320px;
        }
        .col-min {
            /* custom min width */
            min-width:320px;
        }
        .col-max {
            /* custom max width */
            max-width:320px;
        }

        /* visual styles */
        body {
            padding-bottom:40px;
        }
        h1 {
            margin:40px 0px 20px 0px;
            color:#95c500;
            font-size:28px;
            line-height:34px;
            text-align:center;
        }
        .container{
            max-width:99%
        }
        [class*="col-"] {
            padding-top:10px;
            padding-bottom:15px;
            /*border:1px solid #80aa00;*/
            /*background:#d6ec94;*/
        }
        [class*="col-"]:before {
            display:block;position:relative;
            margin-bottom:8px;
            font-family:sans-serif;
            font-size:10px;
            letter-spacing:1px;
            /*color:#658600;*/
            text-align:left;
        }
        .item {
            width:100%;
            height:100%;
            /*border:1px solid #cecece;
            padding:16px 8px;
            background:#ededed;
            background:-webkit-gradient(linear, left top, left bottom,color-stop(0%, #f4f4f4), color-stop(100%, #ededed));
            background:-moz-linear-gradient(top, #f4f4f4 0%, #ededed 100%);
            background:-ms-linear-gradient(top, #f4f4f4 0%, #ededed 100%);*/
        }

        /* content styles */
        .item {
            display:table;
        }
        .content {
            display:table-cell;
            vertical-align:middle;
            text-align:center;
        }
        .content:before {
            font-family:sans-serif;
            font-size:12px;
            letter-spacing:1px;
            color:#747474;
        }

        #measure-buttons{
            padding-bottom:10px;
        }
        
        #mask-buttons{
            padding-bottom:20px;
        }
        
        .fa{
            padding-top:3px;
        }
        .audiogram-container{
            width:500px;
            height:500px;
            border:1px solid #000;
            background:#eeeeee;           
        }
    </style>
  </head>
  <body>
	<div class="container">
	  <div class="row row-centered">
          <div class="col-xs-5 col-centered"  id="left_column">
              <div class="item">
                  <div class="content audiogram-container"><div id="audiogram_right"></div></div>
              </div>
              <div class="item">
                <div class="content clear-button" id="menu1">
                    <a class="btn btn-xs btn-primary" href="#" id="clear1">
                    <i class="fa fa-refresh pull-left"></i> Clear</a>
                </div>
              </div>
          </div>
        <div class="col-xs-2 col-centered">
              <div class="item">
                  <div class="content" id="measure-buttons">
                    <!-- Auditory measure buttons -->
                    <div class="btn-group-vertical" data-toggle="buttons">
                      <label class="btn btn-primary btn-info aud-btn active">
                        <input type="radio" name="measure" id="AC" checked><span class="left" id="ACR"><i class="fa fa-circle-o"></i></span><span class="mid">AC</span><span class="right" id="ACL">&#10005;</span>
                      </label>
                      <label class="btn btn-primary aud-btn">
                        <input type="radio" name="measure" id="BC"><span class="left" id="BCR"><i class="fa fa-chevron-left"></i></span><span class="mid">BC</span><span class="right" id="BCL"><i class="fa fa-chevron-right"></i></span>
                      </label>
                      <label class="btn btn-primary aud-btn">
                        <input type="radio" name="measure" id="MCL"><span class="left">M</span><span class="mid">MCL</span><span class="right">M</span>
                      </label>
                      <label class="btn btn-primary aud-btn">
                        <input type="radio" name="measure" id="UCL"><span class="left">m</span><span class="mid">UCL</span><span class="right">m</span>
                      </label>
                      <label class="btn btn-primary aud-btn">
                        <input type="radio" name="measure" id="SF"><span class="left">S</span><span class="mid">SF</span><span class="right">S</span>
                      </label>
                      <label class="btn btn-primary aud-btn">
                        <input type="radio" name="measure" id="SF-A"><span class="left">A</span><span class="mid">SF-A</span><span class="right">A</span>
                      </label>
                    </div>
                </div>
            </div>
              <div class="item">
                  <div class="content" id="mask-buttons">
                    <a class="btn btn-med btn-primary" href="#" id="mask_button">
                    <i class="fa fa-ban pull-left"></i> Masked</a>
                </div>
            </div>
          </div><!-- End Button Column-->
          <div class="col-xs-5 col-centered" id="right_column">
              <div class="item">
                  <div class="content audiogram-container"><div id="audiogram_left"></div></div>
              </div>
              <div class="item">
                <div class="content clear-button" id="menu2">
                    <a class="btn btn-xs btn-primary" href="#" id="clear2">
                    <i class="fa fa-refresh pull-left"></i> Clear</a>
                </div>
              </div>
          </div>
	  </div> <!-- End Row -->
	</div> <!-- End Container -->
    <script>
    $(function() {
        //combine stuff later        
        
        var stage_right = new Kinetic.Stage({
            container: 'audiogram_right',
            width: 500,
            height: 500
        });
        
        var stage_left = new Kinetic.Stage({
            container: 'audiogram_left',
            width: 500,
            height: 500
        });
        
        var right_side = new AudioGram(stage_right,100,'right');
        var left_side = new AudioGram(stage_left,100,'left');
        
        /*
        * This function highlights the active measure button as well as
        * setting the proper character for each board according to the 
        * measure.
        */
        $( ".aud-btn" ).on( "click", function() {
            setTimeout( function (){
                $( ".aud-btn" ).each(function( index ) {
                    if($( this ).hasClass( "active" )){
                        $( this ).addClass('btn-info');
                    }else{
                        $( this ).removeClass('btn-info');
                    }
                })
                setTimeout( function (){
                    $( ".aud-btn" ).each(function( index ) {
                        if($( this ).hasClass( "active" )){
                            right_side.setCurrentMeasure($( this ).find('input').attr('id'));
                            left_side.setCurrentMeasure($( this ).find('input').attr('id'));
                        }
                    });
                }, 0 );
            }, 0 );
        });
        

        /*
        * When clicking the mask button, toggle mask on and off.
        */
        $( "#mask_button" ).on( "click", function() {
            //Using the .length makes this a boolean operation
            //otherwise, it always returns true
            if($(this).find($(".fa-ban")).length){
                right_side.setMasked(1);
                left_side.setMasked(1);
                $(this).find($(".fa-ban")).removeClass('fa-ban').addClass('fa-check');
                $('#BCL').html(']');
                $('#BCR').html('[');        
                $('#ACL').html('<i class="fa fa-square-o"></i>');
                $('#ACR').html('&#x25b3;');
            }else{
                right_side.setMasked(0);
                left_side.setMasked(0);
                $(this).find($(".fa-check")).removeClass('fa-check').addClass('fa-ban');  
                $('#BCR').html('<i class="fa fa-chevron-left"></i>');
                $('#BCL').html('<i class="fa fa-chevron-right"></i>');
                $('#ACR').html('<i class="fa fa-circle-o"></i>');
                $('#ACL').html('&#10005;');
            }
        });
        
        $( ".clear-button" ).on( "click", function() {
            if($( this ).find('a').attr('id') == 'clear1'){
                right_side.clearStage();
            }else{
                left_side.clearStage();
            }
        });
        
    });
    </script>      
  </body>
</html>