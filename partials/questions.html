

<div data-ng-controller="questionsController">    
    
    <div class="row">
        <div class="col-md-2 col-md-offset-1">
            <label style="font-size: 24px">{{patientName}}</label>
            <label style="font-size: 24px">DOB: {{patientDOB}}</label>
        </div>
        <label style="font-size:2vw; color:#4B92AE" class="col-md-3 col-md-offset-1">{{phaseName}}</label>
        <label style="font-size:2vw;" class="col-md-3 col-md-offset-1">Page {{page}} of {{finalPage}}</label>
    </div>
    <hr>
    <div class="row">
        <div class="col-md-12 col-md-offset-2">
        <form class="form form-verticle col-md-5 col-md-offset-1" id="form_850359" class="appnitro">
            <div class="control-group" >

                <!-- Display All Questions -->
                <ul>
                    <div id="cp_questionDivContainer">
                    <li ng-repeat= "question in finalQuestions">
                        <div ng-hide="question.IsChild">

                            <span id="cp_questionForm">
                            <div class="row">
                                <div class="col-md-11">
                                    <label class="description" style="font-size: 1.2vw; color:#4B92AE" >{{question.QuestionText}} </label>
                                </div>
                                <div class="col-md-1">
                                    <hovercard hover-tmpl-url="js/hoverCardDetail.html"><p style="color:#325bbd" class="fa fa-question-circle fa-2x"></p></hovercard>
                                </div>
                            
                            </div>
                                <!--device questions-->
                                <div ng-if="question.isDevice" ng-repeat="values in question.Input.Values" >
                                    <input type={{question.Input.Type}} value={{values}} name={{question.QuestionID}} ng-model="answer.Answers[question.QuestionID]" ng-blur="postAnswers(question.QuestionID)"  ng-click="showDeviceOptions(values, question.QuestionID)" >
                                    <label class="choice" >{{values}}</label>
                                </div>
                                 <!-- Modal used for writing a message to the Administrator -->
                                  <script type="text/ng-template" id="device.html">
                                    <div class="modal-header">
                                        <button type="button" class="close" ng-click="ok()"><span ng-click="ok()">&times;</span>
                                        <span class="sr-only">Close</span>         
                                        </button>
                                        <h4 class="modal-title" id="myModalLabel">
                                        {{provider}} Devices 
                                        </h4>
                                        
                                    </div>
                                    <div class="modal-body">
                                        <form name="deviceForm" ng-submit="saveDevice(deviceForm.$valid)" novalidate>
                                        <label ng-if="implants"> Please select an implant: </label>
                                        <div class="controls" ng-repeat="implant in implants">
                                            <input type="radio" name="implant" ng-model="answer.Answers[implantQuestion]" value="{{implant.ImplantName}}" required> {{implant.ImplantName}}<br>
                                        </div>
                                        <label ng-if="electrodes"> Please select an electrode: </label>
                                        <div class="controls" ng-repeat="electrode in electrodes">
                                            <input type="radio" name="electrode" ng-model="answer.Answers[electrodeQuestion]" value="{{electrode.ElectrodeName}}" required> {{electrode.ElectrodeName}}<br>
                                        </div>
                                        <label ng-if="processors"> Please select a processor: </label>
                                        <div class="controls" ng-repeat="processor in processors">
                                            <input type="radio" name="processor" ng-model="answer.Answers[processorQuestion]" value="{{processor.ProcessorName}}"> {{processor.ProcessorName}}<br>
                                        </div>
                                        
                                        <br><br>
                                        <button class="btn btn-primary" type="submit" ng-disabled="deviceForm.$invalid">Save Device</button>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-primary" ng-click="ok()"> Close </button>
                                    </div>
                                </script>
                                <!-- Else Display only the single Input field -->
                                <select class="form-control medium" ng-if="question.Input.Type == 'Select'" ng-options="values for values in question.Input.Values"
                                        ng-model="answer.Answers[question.QuestionID]" ng-blur="postAnswers(question.QuestionID)">
                                </select>
                                <div ng-if="question.Input.Type == 'Date'">
                                    <input class="form-control medium" type={{question.Input.Type}} name={{question.QuestionID}} 
                                           ng-model="answer.Answers[question.QuestionID]" ng-blur="postDateAnswers(question.QuestionID)">
                                </div>
                                <div ng-if="question.Input.Type == 'Text'">
                                    <input type={{question.Input.Type}} name={{question.QuestionID}} 
                                           ng-model="answer.Answers[question.QuestionID]" ng-blur="postAnswers(question.QuestionID)">
                                </div>
                                <div ng-if="question.Input.Type == 'Radio' && !question.isDevice" ng-repeat="values in question.Input.Values" >
                                    <input type={{question.Input.Type}} value={{values}} name={{question.QuestionID}} 
                                           ng-model="answer.Answers[question.QuestionID]" ng-blur="postAnswers(question.QuestionID)">
                                    <label class="choice" >{{values}}</label>
                                </div>
                                <div ng-if="question.Input.Type == 'Checkbox'" ng-repeat="values in question.Input.Values" >
                                    <input type={{question.Input.Type}} checklist-value="values" 
                                           checklist-model="answer.Answers[question.QuestionID]" ng-blur="postAnswers(question.QuestionID)">
                                    <label class="choice" >{{values}}</label>
                                </div>
                                
                                <div ng-if="question.Input.Type == 'SurgeryHistory'">
                                    <div ng-repeat="subfield in question.Input.Values">
                                        <br>
                                        
                                        <!--Here is the text style!!!!-->
                                        <div>
                                            <label id="cp_textStyle" class="description" 
                                                   ng-if="subfield.Name !='Type of Surgery: Other'">{{subfield.Name}} </label>
                                            <div ng-if="subfield.Type == 'Date'">
                                                <input type="Date" name={{subfield.Name}} 
                                                       ng-model="surgery.Date" ng-blur="">
                                            </div>
                                            <div ng-if="subfield.Type == 'Text'" ng-hide="surgery['Type of Surgery?']!='Other'">
                                                <label id="cp_textStyle" class="description" name={{subfield.Name}}>{{subfield.Name}} </label>
                                                <input type="Text" name={{question.QuestionID}}
                                                       ng-model="surgery['Other']" ng-blur="postSurgery()" 
                                                       placeholder="Type in other type of surgery">
                                            </div>
                                            <div ng-if="subfield.Type == 'Radio'" ng-repeat="values in subfield.Values" >
                                                <input type="Radio" value={{values}} name={{subfield.Name}} 
                                                       ng-model="surgery[subfield.Name]" 
                                                       ng-if="surgery['Type of Surgery?']!='Other'&& surgery['Type of Surgery?']!=null"
                                                       ng-blur="postSurgery()">
                                                <input type="Radio" value={{values}} name={{subfield.Name}} 
                                                       ng-model="surgery[subfield.Name]" 
                                                       ng-if="(surgery['Type of Surgery?']=='Other' || surgery['Type of Surgery?']==null) && surgery['Side?'] != null || surgery['Side?'] == null">
                                                <label class="choice" >{{values}}</label>
                                            </div>
                                            
                                        </div>

                                    </div>
                                    <button type="button" class="btn btn-default btn-sm" ng-click="clearSurgeryHistory()">
                                      <span class="glyphicon glyphicon-plus-sign"></span> Add another surgery
                                    </button>
                                </div>
                                <!--<p class="fa fa-question-circle" ng-mouseenter="help=true" ng-mouseleave="help=false">
                                <small ng-show="help">{{question.QuestionHelp}}</small>
                            </p>-->
                                
                                
                            </span>
                                                        
                            
                            
                            
                        </div>

                        <!-- Divs with logic used to display or hide children questions -->

                        <div ng-if="question.Input.Type != 'Checkbox'">
                            <div ng-if="question.Trigger == answer.Answers[question.QuestionID] && question.Trigger != null">
                                {{showChild(question.Children)}}
                            </div>

                            <div ng-if="question.Trigger != answer.Answers[question.QuestionID] || question.Trigger == null">
                                {{hideChild(question.Children)}}
                            </div>
                        </div>

                        <div ng-if="question.Input.Type == 'Checkbox'">
                            <div ng-if="checkboxTrigger(answer.Answers[question.QuestionID])">
                                {{showChild(question.Children)}}
                            </div>

                            <div ng-if="checkboxTrigger(answer.Answers[question.QuestionID]) == false">
                                {{hideChild(question.Children)}}               
                            </div>
                        </div>
                        
                        


                    </li>

                        <!--Don't know what that is doing ng-if="offSet 0" -->
                    
                    <button ng-if="offSet > 0" class="questionsButton btn btn-primary" ng-click="previousPage()" style="float:left">Back</button>
                        
                    <button ng-if="finished == false" class="btn btn-primary" ng-click="nextPage()" style="float:right">Continue</button>
                        
                    <a href="#/patientDirectory" >
                    <button ng-if="finished == true" class="questionsButton btn btn-primary" style="float:right" 
                            popover="Click to save data but remain in this phase" popover-trigger="mouseenter" popover-placement="right" ng-click="saveUnanswered()">
                        
                        Save
                        </button> &nbsp;
                        </a>
                    <button ng-click="getDataSummary()" ng-if="finished == true" class="btn btn-default"
                            popover="Click to review data entry for this phase before concluding this visit" popover-placement="bottom" popover-trigger="mouseenter" style="float:right" ng-click="saveUnanswered()">
                        Finished
                    </button>
                    <br>
                    </div>
                </ul>
                <!-- End Display Of All Questions -->

            </div>
        </form>
        <!--
        <div id="cp_questionsReportForm" class="col-md-4 col-md-offset-1">
        <h3>Patient Summary for {{patientName}}</h3><br>
        
        <div class="btn-group" dropdown is-open="status.isopen">
          <button type="button" class="btn btn-primary dropdown-toggle" ng-disabled="disabled">
            Choose Care Phase <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu">
            <li><a href="" ng-click="patientSummary(1)">Demographics</a></li>
            <li><a href="" ng-click="patientSummary(2)">Candidacy Testing</a></li>
            <li><a href="" ng-click="patientSummary(3)">Initial Surgical Consultation</a></li>
            <li><a href="" ng-click="patientSummary(4)">Preoperative Visit</a></li>
            <li><a href="" ng-click="patientSummary(5)">One Week Postoperative</a></li>
            <li><a href="" ng-click="patientSummary(6)">Activation</a></li>
            <li class="divider"></li>
            <li><a href="" ng-click="patientSummary(7)">1 Month</a></li>
            <li><a href="" ng-click="patientSummary(8)">3 Month</a></li>
            <li><a href="" ng-click="patientSummary(9)">6 Month</a></li>
            <li><a href="" ng-click="patientSummary(10)">12 Month</a></li>
            <li><a href="" ng-click="patientSummary(11)">24 Month</a></li>
          </ul>
        </div>
        
        <button type="button" class="btn btn-primary" ng-click="patientSummary(0)">Close Form</button>
        
        <br>
        
        <div ng-if="clickedPhase == 1 || clickedPhase == 3 || clickedPhase == 4 || clickedPhase == 5 || clickedPhase == 6">
            <br>
            <completed-questions></completed-questions>
        </div>
        <div ng-if="clickedPhase == 2 || clickedPhase == 7 || clickedPhase == 8 || clickedPhase == 9 || clickedPhase == 10 || clickedPhase == 11"
             ng-repeat="condition in patientSummaryAnswers">
            <br>
           <completed-audiology></completed-audiology>
        </div>
        </div>

        </div><!--COL 6 div-->

    
        
        <script type="text/ng-template" id="dataSummary.html">

        <div data-ng-controller="questionsController"> 
            <div class="modal-header">
                <button type="button" class="close"><span ng-click="ok()">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="myModalLabel">Review Data entered</h4>
            </div>
            <div id="divtoprint">
                <div class="modal-body">
                    <completed-questions></completed-questions>
                </div>
            </div>

            <div class="modal-footer" ng-controller="questionsController">
                <button ng-click="ok()" class="btn btn-default"
                         style="float:left">
                    Back
                </button>

                <button ng-click="PrintContent()" class="btn btn-default" style="margin-right:15%">
                    Print
                </button>

                <button ng-click="export()" class="btn btn-default" style="margin-right:10%">
                    Export & Save
                </button>

                <button ng-click="completePhase(); ok()" class="btn btn-default"
                        popover="Click to complete data entry for this phase and conclude this visit" popover-trigger="mouseenter" popover-placement="bottom" style="float:right">
                    Confirm
                </button>
            </div>
        </div>

        </script>

        </div>
    </div>
</div>
    