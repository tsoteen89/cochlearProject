<div class ="row">

    <button ng-click="export()" class="btn btn-info ">
        Export To Spreadsheet
    </button> <br> <br>
</div>

<div id="facReport"> <!--ID used to identify exportable html-->
  <!--<span ng-repeat="test in audioQuestions.Tests">{{test}}</span>-->
<style>
   table, th, td, tbody, tr {
   border: 1px solid #164a5e;
   }
   .purple{
   background-color: #9ca0c4;
   }
   .blue{
   background-color:#cae5f0
   }
    tbody tr:hover {
      background: #97afd4;
    } 
</style>
    <table class="form3D " style="table-layout:fixed" >
        <thead ng-if="showReport">
            <tr style="background-color:#cae5f0;" align="center"> 
                <td style="width:200px;"> <h4> Patient </h4></td> 
                <td style="width:100px"><h4>  Test </h4></td> 
                <td style="width:240px"> <h4> Measure </h4> </td> 
                <td colspan="{{getMaxNumOfConditionSets(phase.PhaseID)}}" ng-attr-style="width:{{getMaxNumOfConditionSets(phase.PhaseID)*303}}px" ng-repeat= "phase in facilityReport.Phases"><h4>  {{phase.Name}}</h4> </td>
            </tr>
        </thead>
        <tbody ng-repeat="patient in facilityReport.Patients" ng-class-odd="'odd'" ng-class-even="'even'">
            <tr ng-repeat="careTeam in patient.CareTeams" >
                <!--Patient Name and Event Details -->
                <td align="center"  style="width:200px;">
                    <b> {{patient.First}} {{patient.Last}} <br> {{careTeam.Description}} </b>
                </td>
                <!--AzBio, CNC, BKB-SIN-->
                <td > 
                    <table style="width:100%">
                        <tr><td style="height:66px;"></td></tr>
                        <tr>
                            <td>
                                <table ng-repeat="test in audioQuestions.Tests" style=" width:100%;">
                                    <tr ng-attr-style="height:{{test.AudioTestInput.length*23}}px">
                                        <td><b> {{test.AudioTestName}}</b></td> 
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </td>
                <!-- List, SNR, etc; specific to the test-->
                <td >
                    <table style="width:100%">
                        <tr><td style="height:66px"></td></tr>
                        <tr>
                            <td>
                                <table ng-repeat="test in audioQuestions.Tests" style=" width:100%;">
                                    <tr  ng-repeat="field in test.AudioTestInput">
                                        <td ><b> {{field.Name}}</b></td> 
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>             
                </td>
                <!-- Results for each test and field AND PHASE- wah wah--> 
                <td ng-repeat="phase in facilityReport.Phases" colspan="{{getMaxNumOfConditionSets(phase.PhaseID)}}" >
                    <table style="width:100%" >
                        <tr>
                            <td ng-repeat="conditionSet in careTeam.Data[phase.PhaseID].DetailedAnswers" style="width:300px">
                                <table style="width:300px"> 
                                    <tr><td colspan="2" align="center"><b> Testing Conditions </b></td></tr>
                                    <tr>
                                        <td style="width:50%;height:43px" ><b> Left Ear:</b> {{conditionSet.LeftAidCondition}} </td>
                                        <td  style="width:50%;height:43px"><b> Right Ear:</b>
                                            {{conditionSet.RightAidCondition}} </td>  
                                    </tr>
                                </table>

                               <table ng-repeat="test in audioQuestions.Tests" style="width:300px;" >
                                    <tr  ng-repeat="field in test.AudioTestInput">
                                        <td ng-if="!conditionSet.Results[test.AudioTestName]" style="height:23px"> </td>
                                        <td ng-if="conditionSet.Results[test.AudioTestName]"
                                            ng-repeat="result in conditionSet.Results[test.AudioTestName]"align="left" >
                                            {{result[field.Name]}}
                                            <span ng-if="$last" >{{clearMessage()}}
                                        </td>
                                    </tr>
                                </table> 

                            </td>
                        </tr>
                    </table>
                </td>
                      
            </tr>          
        </tbody>
      
    </table>

</div>

<!--<span ng-if="$last" >{{clearMessage()}}  -->
