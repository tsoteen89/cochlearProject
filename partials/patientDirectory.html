<div id = "cp_patientDirectory">
  <div ng-controller="apiPatientsController">
    <h1>Patient Overviews</h1>
    <div ng-repeat="patient in patientsData.records" ng-controller="phaseProgressCtrl">
      <div ng-controller="collapseCtrl" ng-mouseleave="isDataCollapsed = true; isPatientCollapsed = true">
        <div class="container">
          <div class = "cp_patientInfo">
            <div id = "cp_patientContainer">
              <p id = "cp_patientFname">{{patient.First }}  {{patient.Last |uppercase }}</p>
              <p class = "cp_patientSex" ng-if=patient.Sex=='m'>Male</p>
              <p class = "cp_patientSex" ng-if=patient.Sex=='f'>Female</p>
              <p class = "cp_patientAge">Age</p>
              <p ng-if="patient.CareTeams.length==1"></p>
              <p ng-if="patient.CareTeams.length==2"></p>
            </div>
            <button id = "cp_patientDetailsButton" ng-click="isPatientCollapsed = !isPatientCollapsed">    Patient Details
            </button>
            <div id = "cp_patientCollapse" collapse="isPatientCollapsed">
                <hr>
                <span class = "cp_extraPatientInfo">BMI:</span> &nbsp; {{patient.BMI}}<br>
                <span class = "cp_extraPatientInfo">Weight:</span> &nbsp; {{patient.Weight}} lbs<br>
                <span class = "cp_extraPatientInfo">Height:</span> &nbsp; {{patient.Height/12 | number:0}} ft {{patient.Height%12}} in<br>
                <span class = "cp_extraPatientInfo">Phone:</span> &nbsp; ({{patient.Phone.slice(0,3)}}){{patient.Phone.slice(3,6)}}-{{patient.Phone.slice(6)}}<br>
                <span class = "cp_extraPatientInfo">Email:</span> &nbsp; <a id = "cp_email" href="mailto:{{patient.Email}}">{{patient.Email}}</a><br>
                <span class = "cp_extraPatientInfo">Address:</span> &nbsp; {{patient.Address1}} {{patient.City}}, {{patient.State}} {{patient.Zipcode}}<br>
            </div>
          </div>

          <div class="cp_patientPhase" ng-controller="dotProgressCtrl">
            <div class = "cp_patientPhaseData" ng-repeat="careTeam in patient.CareTeams">
              Event: {{careTeam.Description}}<br>
              Current Phase : {{careTeam.CurrentPhaseID}}<br>
              {{setProgress(careTeam)}}
              <div class="row bs-wizard">
                <div class="col-xs-1 bs-wizard-step complete" ng-repeat="phase in phases|limitTo:careTeam.CurrentPhaseID-1">
                  <div class="text-center bs-wizard-stepnum">
                    &nbsp;
                  </div>
                  <div class="progress" >
                    <div class="progress-bar">
                    </div>
                  </div>
                  <a ng-if="phase.PhaseID < 7 && phase.PhaseID != 2" href="#/questions" ng-click="goToQuestions(careTeam, phase)" class="bs-wizard-dot"></a>
                  <a ng-if="phase.PhaseID < 12 && (phase.PhaseID > 6 || phase.PhaseID ==2)" href="#/audioQuestions" ng-click="goToQuestions(careTeam, phase)" class="bs-wizard-dot"></a>
                  <div class="bs-wizard-info text-center">
                    {{phase.Name}}
                  </div>
                </div>
                <div class="col-xs-1 bs-wizard-step active" >
                  <div class="text-center bs-wizard-stepnum">
                    &nbsp;
                  </div>
                  <div class="progress" >
                    <div class="progress-bar">
                    </div>
                  </div>
                  <a ng-if="careTeam.CurrentPhaseID < 7 && careTeam.CurrentPhaseID != 2" href="#/questions"
                  ng-click="goToQuestions(careTeam,phases[careTeam.CurrentPhaseID-1])" class="bs-wizard-dot"></a>
                  <a ng-if="careTeam.CurrentPhaseID < 12 && (careTeam.CurrentPhaseID > 6 || careTeam.CurrentPhaseID ==2)" href="#/audioQuestions" ng-click="goToQuestions(careTeam,phases[careTeam.CurrentPhaseID-1])" class="bs-wizard-dot"></a>
                  <div class="bs-wizard-info text-center">
                    {{phases[careTeam.CurrentPhaseID-1].Name}}
                  </div>
                </div>
                <div class="col-xs-1 bs-wizard-step disabled" ng-repeat="phase in phases.slice(careTeam.CurrentPhaseID, 11)">
                  <div class="text-center bs-wizard-stepnum">
                    &nbsp;
                  </div>
                  <div class="progress" >
                    <div class="progress-bar">
                    </div>
                  </div>
                  <a href="#/questions" ng-click="goToQuestions(careTeam, phase.PhaseID, phase.Name)" class="bs-wizard-dot"></a>
                  <div class="bs-wizard-info text-center">
                    {{phase.Name}}
                  </div>
                </div>
              
              </div>
              <button id = "cp_patientPhaseDetails" ng-click="toggleDataCollapse()">
                See Care Team Details 
              </button>
              <div id = "cp_phaseDetails" collapse="isDataCollapsed">
                  <span class = "cp_patientName">{{patient.First}} {{patient.Last}}'s</span><span> Implant Providers</span><br>
                  <a ng-repeat="facility in patient.Providers">
                    <span>{{facility.Name}}</span><br>
                  </a><br>
                  <div style="float:left">
                    Implant type: Cochlear Nucleus CI422 with Slim Straight Electrode<br>
                    Sound Processor Type: CP920 (without Accessory Port)
                </div>
              </div>
            </div>
          </div>
        <div>
        <!--Collapseable Content-->
        <!-- 
        <div class="container" style="margin:1%">
        </div>
        -->
      </div>
    </div>
  </div>
</div>

